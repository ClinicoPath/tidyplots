---
title: "Visualizing Data"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Visualizing-data}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
# knitr::opts_chunk$set(
#   collapse = TRUE,
#   comment = "#>"
# )
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  results = FALSE,
  message = FALSE,
  warning = FALSE,
  fig.align = "center",
  fig.width = 5,
  fig.height = 2.5,
  dpi = 300
)

```

```{r setup}
library(tidyplots)
```
# Amounts

# Distributions

```{r}

energy %>% 
  tidyplot(x = power_in_gw) %>% 
  add_histogram()

energy %>% 
  tidyplot(x = power_in_gw) %>% 
  add_density_curve()

energy %>% 
  tidyplot(x = power_in_gw) %>% 
  add_density_histogram() %>% 
  add_density_curve()

# multiple distributions

energy %>% 
  tidyplot(x = energy_type, y = power_in_gw, color = energy_type) %>% 
  add_violin()

energy %>% 
  tidyplot(x = energy_type, y = power_in_gw, color = energy_type) %>% 
  add_jitter(jitter_width = 0.8, alpha = 0.3)

energy %>% 
  tidyplot(x = energy_type, y = power_in_gw, color = energy_type) %>% 
  add_violin() %>% 
  add_jitter(jitter_width = 0.8, alpha = 0.3)

```


# Proportions

## Subproportions

## Megadrom

### Subsubheading

```{r}

# themes

p4 <- 
  energy %>% 
  tidyplot(Year, power_in_gw, color = energy_source) %>% 
  add_barstack_absolute()

p4
p4 %>% theme_minimal_y()
p4 %>% theme_ggplot2()

# proportions

energy %>% 
  tidyplot(Year, power_in_gw, color = energy_source) %>% 
  add_barstack_absolute()

energy %>% 
  tidyplot(Year, power_in_gw, color = energy_source) %>% 
  add_barstack_relative()

energy %>% 
  dplyr::filter(Year %in% c(2005, 2010, 2015, 2020)) %>% 
  tidyplot(y = power_in_gw, color = energy_source) %>% 
  add_pie() %>% 
  split_plot(by = Year)

energy %>% 
  dplyr::filter(Year %in% c(2005, 2010, 2015, 2020)) %>% 
  tidyplot(y = power_in_gw, color = energy_source) %>% 
  add_donut() %>% 
  split_plot(by = Year)

energy_week %>% 
  tidyplot(Date, power_in_mw, color = energy_source) %>% 
  add_line() %>% 
  remove_padding()

energy_week %>% 
  tidyplot(Date, power_in_mw, color = energy_source) %>% 
  add_area(alpha = 0.3)

energy_week %>% 
  tidyplot(Date, power_in_mw, color = energy_source) %>% 
  add_areastack_absolute(alpha = 0.3)

energy_week %>% 
  tidyplot(Date, power_in_mw, color = energy_source) %>% 
  add_areastack_relative(alpha = 0.3)

###

energy %>% 
  tidyplot(Year, power_in_gw, color = energy_type) %>% 
  add_barstack_absolute()

energy %>% 
  tidyplot(Year, power_in_gw, color = energy_type) %>% 
  add_barstack_relative()

new_colors <- c("Fossil" = "grey",
               "Nuclear" = "#F6C54D",
               "Renewable" = "#4FAE62",
               "Other" = "#C02D45")

energy %>% 
  dplyr::filter(Year %in% c(2005, 2010, 2015, 2020)) %>% 
  tidyplot(y = power_in_gw, color = energy_type) %>% 
  add_pie() %>% 
  adjust_colors(new_colors = new_colors) %>% 
  split_plot(by = Year)

energy %>% 
  dplyr::filter(Year %in% c(2005, 2010, 2015, 2020)) %>% 
  tidyplot(y = power_in_gw, color = energy_type) %>% 
  add_donut() %>% 
  adjust_colors(new_colors = new_colors) %>%  
  split_plot(by = Year)

energy %>% 
  dplyr::filter(Year %in% c(2005, 2010, 2015, 2020)) %>% 
  dplyr::summarize(power_in_gw = sum(power_in_gw, na.rm = TRUE), .by = c(energy_type, Year)) %>% 
  tidyplot(x = Year, y = power_in_gw, color = energy_type) %>% 
  add_line(dodge_width = 0) %>%
  add_mean_dot(dodge_width = 0) %>% 
  adjust_colors(new_colors = new_colors)

energy_week %>% 
  tidyplot(Date, power_in_mw, color = energy_type) %>% 
  add_line() %>%
  remove_padding()

energy_week %>% 
  dplyr::summarise(power_in_mw = sum(power_in_mw), .by = c(Date, energy_type)) %>% 
  tidyplot(Date, power_in_mw, color = energy_type) %>% 
  add_area(alpha = 0.3) %>% 
  adjust_colors(new_colors = new_colors)

energy_week %>% 
  dplyr::summarise(power_in_mw = sum(power_in_mw), .by = c(Date, energy_type)) %>% 
  tidyplot(Date, power_in_mw, color = energy_type) %>% 
  add_areastack_absolute(alpha = 0.3) %>% 
  adjust_colors(new_colors = new_colors)

energy_week %>%
  dplyr::summarise(power_in_mw = sum(power_in_mw), .by = c(Date, energy_type)) %>% 
  tidyplot(Date, power_in_mw, color = energy_type) %>% 
  add_areastack_relative(alpha = 0.3) %>% 
  adjust_colors(new_colors = new_colors)

```


# Uncertainty

```{r}
df_demo %>% 
  tidyplot(x = category, y = value, color = category) %>% 
  add_mean_dash() %>% 
  add_ci(conf.int = 0.95)

df_demo %>% 
  tidyplot(x = category, y = value) %>% 
  add_ci_ribbon(conf.int = 0.95) %>% 
  add_line() %>% 
  add_jitter()


df_demo %>% 
  tidyplot(x = category, y = value) %>% 
  add_ci_ribbon(conf.int = 0.95) %>% 
  add_line() %>% 
  add_jitter() %>% 
  adjust_colors("orange")

```


# x--y relationships

```{r}
mtcars %>%
  tibble::as_tibble(rownames = "name") %>% 
  tidyplot(mpg, disp) %>% 
  add_scatter() %>% 
  add_scatter(subset_data = . %>% dplyr::filter(disp > 350), color = "red") %>% 
  add_text(subset_data = . %>% dplyr::filter(disp > 350), var = name, color = "black") %>% 
  add_reference_lines(x = c(20, 30), y = c(200, 350))

energy_week %>% 
  tidyplot(Date, power_in_mw, color = energy_source) %>% 
  add_line() %>% 
  remove_padding()

energy_week %>% 
  tidyplot(Date, power_in_mw, color = energy_source) %>% 
  add_area(alpha = 0.3)

```

